@layout ProfileLayout
@page "/profile"
@using Entertainmentcareers.net.Shared;
@inject AuthenticationStateProvider AuthStateProvider
@inject MudBlazor.ISnackbar snackBar
@inject HttpClient Http

<MudGrid Justify="Justify.Center" Class="mt-8 mb-8">
    <MudItem xs="10">
        <MudGrid Justify="Justify.Center" Class="border">
            <MudItem xs="12">
                <MudText Typo="Typo.h4" Style="font-family: 'Inter';font-weight: 700; color:#08243D;" Class="pb-2">Account Overview</MudText>
                <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="pb-2">Welcome back to your account, <b>@user.FirstName.</b></MudText>
            </MudItem>
            <MudItem xs="6">
                <MudGrid Class="mb-2" Justify="Justify.Center">
                    <MudItem xs="12">
                        <MudCard Style="background-color:#EEF5F8">
                            <MudCardContent>
                                 <MudGrid>
                                     <MudItem xs="12">
                                         <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="border-bottom"><b>Account Information</b></MudText>
                                     </MudItem>
                                     <MudItem xs="2">
                                         <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Login ID:</b></MudText>
                                     </MudItem>
                                     <MudItem xs="10">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">@user.Email</MudText>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="text-transform:none;" Label="Change Login"></MudFab>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="text-transform:none;" Label="Change Password"></MudFab>
                                     </MudItem>
                                    <MudItem xs="2">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Name:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="10">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">@user.FirstName @user.LastName</MudText>
                                    </MudItem>
                                    <MudItem xs="2">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Address:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="10">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">@user.Street,<br />@user.City, @user.State, @user.Zip</MudText>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="text-transform:none;" Label="Change Personal Information"></MudFab>
                                    </MudItem>
                                 </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                    <MudItem xs="12">
                        <MudCard Style="background-color:#EEF5F8">
                            <MudCardContent>
                                <MudGrid>
                                     <MudItem xs="12">
                                         <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="border-bottom"><b>Billing Information</b></MudText>
                                     </MudItem>
                                     <MudItem xs="2">
                                         <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Type:</b></MudText>
                                     </MudItem>
                                     <MudItem xs="10">
                                         <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">@user.PlanType</MudText>
                                     </MudItem>
                                    <MudItem xs="2">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Expires:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="10">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">#Expire Date</MudText>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="text-transform:none;" Label="Billing Details"></MudFab>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="background-color: #689F38; color: #FFFFFF;text-transform:none;" Label="Renew"></MudFab>
                                        <MudFab Size="Size.Small" Class="mt-6" Style="text-transform:none;" Label="Cancel"></MudFab>
                                    </MudItem>
                                 </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                </MudGrid>
            </MudItem>
            <MudItem xs="6">
                <MudGrid Justify="Justify.Center">
                    <MudItem xs="12">
                        <MudCard Style="background-color:#EEF5F8">
                            <MudCardContent>
                                <MudGrid>
                                    <MudItem xs="12">
                                        <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="border-bottom"><b>Resumes</b></MudText>
                                        <MudFab Size="Size.Small" Class="mt-2" Style="text-transform:none;" Label="Add Resume"></MudFab>
                                    </MudItem>
                                </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                    <MudItem xs="12">
                        <MudCard Style="background-color:#EEF5F8">
                            <MudCardContent>
                                <MudGrid>
                                    <MudItem xs="12">
                                        <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="border-bottom"><b>Cover Letters</b></MudText>
                                        <MudFab Size="Size.Small" Class="mt-2" Style="text-transform:none;" Label="Add Cover Letter"></MudFab>
                                    </MudItem>
                                </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                    <MudItem xs="12">
                        <MudCard Style="background-color:#EEF5F8">
                            <MudCardContent>
                                <MudGrid>
                                    <MudItem xs="12">
                                        <MudText Typo="Typo.h6" Style="font-family: 'Inter'; color:#08243D;" Class="border-bottom"><b>Personalization & Email Alerts</b></MudText>
                                    </MudItem>
                                    <MudItem xs="3">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Email Alert:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="9">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">#Alert</MudText>
                                    </MudItem>
                                    <MudItem xs="3">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Categories:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="9">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">#Category</MudText>
                                    </MudItem>
                                    <MudItem xs="3">
                                        <MudText Typo="Typo.subtitle2" Style="font-family: 'Inter';color:#08243D;"><b>Locations:</b></MudText>
                                    </MudItem>
                                    <MudItem xs="9">
                                        <MudText Typo="Typo.body2" Style="font-family: 'Inter';color:#08243D;">#Location</MudText>
                                    </MudItem>
                                    <MudItem xs="12">
                                        <MudText Typo="Typo.caption" Style="font-family: 'Inter'; color:#08243D;">You have not set your email preferences.<br />You can receive a daily or weekly email that will include all jobs that meet your profile.</MudText>
                                        <br/>
                                        <MudFab Size="Size.Small" Class="mt-2" Style="background-color: #689F38; color: #FFFFFF; text-transform:none;" Label="Set Your Preferences"></MudFab>
                                    </MudItem>
                                </MudGrid>
                            </MudCardContent>
                        </MudCard>
                    </MudItem>
                </MudGrid>
            </MudItem>
        </MudGrid>
    </MudItem>
</MudGrid>


@code {
    ApplicationUser user = new ApplicationUser();

    protected override async Task OnInitializedAsync()
    {
        var appUser = (await AuthStateProvider.GetAuthenticationStateAsync()).User.Identity;

        if (appUser != null && appUser.IsAuthenticated)
        {
            var username = appUser.Name;
            var result = await Http.GetFromJsonAsync<ApplicationUser>($"api/ApplicationUser/user/{username}");
            if (result != null)
            {
                user = result;
            }
        }
    }
}
